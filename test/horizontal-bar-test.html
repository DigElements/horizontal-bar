<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1.0, user-scalable=yes">
  <script src="../../webcomponentsjs/webcomponents-lite.js"></script>
  <script src="../../web-component-tester/browser.js"></script>
  <link rel="import" href="../horizontal-bar.html">
</head>

<body>
  <test-fixture id="horizontal-bar-fixture">
    <template>
      <horizontal-bar></horizontal-bar>
    </template>
  </test-fixture>

  <script>
    suite('horizontal-bar tests', function() {
      var element;

      setup(function() {
        element = fixture('horizontal-bar-fixture');
        element.name = 'myName';
        element.count = 500;
        element.width = 100;
      });

      test('properties are set to correct values', function() {
        expect(element.name).to.equal('myName');
        expect(element.count).to.equal(500);
        expect(element.width).to.equal(100);
        expect(element.selected).to.be.false;
        expect(element.toggleProperty).to.equal('onToggle');
        expect(element.toggleListener).to.be.an('Object');
        expect(element.toggleListener.onToggle).to.be.a('Function');
      });

      test('does have a paper-checkbox', function() {
        var checkbox = element.$$('paper-checkbox');
        expect(checkbox).to.exist;
        expect(checkbox.name).to.equal('myName');
        expect(checkbox.checked).to.be.false;
      });

      test('does have a bar', function() {
        var bar = element.$$('.bar');
        expect(bar).to.exist;
        expect(bar.style.width).to.equal('100%');
      });

      test('_onToggle does toggle selected', function() {
        element._onToggle();
        expect(element.selected).to.be.true;
        element._onToggle();
        expect(element.selected).to.be.false;
      });

      test('_onToggle does call toggleListener.onToggle', function(done) {
        element.toggleListener = {
          onToggle: function() {
            done();
          }
        };
        flush(function() {
          element._onToggle();
        });
      });

      test('changing the checkbox does call toggleListener.onToggle', function(done) {
        element.toggleListener = {
          onToggle: function() {
            done();
          }
        };
        flush(function() {
          element.$$('paper-checkbox').fire('change');
        });
      });
    });

    suite('horizontal-bar tests with custom listener', function() {
      var element;

      setup(function() {
        element = fixture('horizontal-bar-fixture');
        element.name = 'mySecondName';
        element.count = 5;
        element.width = 50;
        element.toggleProperty = 'myProperty';
        element.toggleListener = {
          myProperty: function() {}
        };
      });

      test('properties are set to correct values', function() {
        expect(element.name).to.equal('mySecondName');
        expect(element.count).to.equal(5);
        expect(element.width).to.equal(50);
        expect(element.selected).to.be.false;
        expect(element.toggleProperty).to.equal('myProperty');
        expect(element.toggleListener).to.be.an('Object');
        expect(element.toggleListener.myProperty).to.be.a('Function');
      });

      test('does have a paper-checkbox', function() {
        var checkbox = element.$$('paper-checkbox');
        expect(checkbox).to.exist;
        expect(checkbox.name).to.equal('mySecondName');
        expect(checkbox.checked).to.be.false;
      });

      test('does have a bar', function() {
        var bar = element.$$('.bar');
        expect(bar).to.exist;
        expect(bar.style.width).to.equal('50%');
      });

      test('_onToggle does toggle selected', function() {
        element._onToggle();
        expect(element.selected).to.be.true;
        element._onToggle();
        expect(element.selected).to.be.false;
      });

      test('_onToggle does call toggleListener[toggleProperty]', function(done) {
        element.toggleListener = {
          myProperty: function() {
            done();
          }
        };
        flush(function() {
          element._onToggle();
        });
      });

      test('changing the checkbox does call toggleListener[toggleProperty]', function(done) {
        element.toggleListener = {
          myProperty: function() {
            done();
          }
        };
        flush(function() {
          element.$$('paper-checkbox').fire('change');
        });
      });
    });
  </script>
</body>
</html>
